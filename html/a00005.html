<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>core_arena: src/core_arena.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">core_arena
   &#160;<span id="projectnumber">v0.0.1</span>
   </div>
   <div id="projectbrief">An arena allocater that uses core memory aside malloc.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">core_arena.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A general purpose arena strategy that is based on malloc.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="a00008_source.html">core_arena.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for core_arena.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00006.svg" width="575" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="a00005_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html">arena</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Our struct for book keeping of the arena and its storage .  <a href="a00020.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gafa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00011.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(a,  b)&#160;&#160;&#160;a &gt; b ? a : b;</td></tr>
<tr class="memdesc:gafa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple MAX macro, since no sideeffects.  <a href="a00011.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">More...</a><br /></td></tr>
<tr class="separator:gafa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab561f26e19b2d5c4428c1ae99442f74e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00012.html#gab561f26e19b2d5c4428c1ae99442f74e">NO_ARENA_LOGGING</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:gab561f26e19b2d5c4428c1ae99442f74e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant for no logging.  <a href="a00012.html#gab561f26e19b2d5c4428c1ae99442f74e">More...</a><br /></td></tr>
<tr class="separator:gab561f26e19b2d5c4428c1ae99442f74e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga55710d867b81d742af6057b89017ba7b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00012.html#ga55710d867b81d742af6057b89017ba7b">LOG_CHUNK_MALLOCS</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ga55710d867b81d742af6057b89017ba7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant for logging allocations of memory for the arenas.  <a href="a00012.html#ga55710d867b81d742af6057b89017ba7b">More...</a><br /></td></tr>
<tr class="separator:ga55710d867b81d742af6057b89017ba7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1916d6f5e5c7448b09095b19899b482c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00012.html#ga1916d6f5e5c7448b09095b19899b482c">FULL_ARENA_LOGGING</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga1916d6f5e5c7448b09095b19899b482c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant for logging bothh allocations of memory <em>for</em> the arenas, and the allocations of memory <em>from</em> the arenas.  <a href="a00012.html#ga1916d6f5e5c7448b09095b19899b482c">More...</a><br /></td></tr>
<tr class="separator:ga1916d6f5e5c7448b09095b19899b482c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d01238a144ad33406ade8b5c2935105"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00012.html#ga6d01238a144ad33406ade8b5c2935105">ARENAS_LOG_LEVEL</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ga6d01238a144ad33406ade8b5c2935105"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaa3c04ba804275765a4e49c9872d46a25"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="a00020.html">arena</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00011.html#gaa3c04ba804275765a4e49c9872d46a25">Arena</a></td></tr>
<tr class="memdesc:gaa3c04ba804275765a4e49c9872d46a25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typedef of struct arena.  <a href="a00011.html#gaa3c04ba804275765a4e49c9872d46a25">More...</a><br /></td></tr>
<tr class="separator:gaa3c04ba804275765a4e49c9872d46a25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gacb4c45a8b06492753c41014f447033a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00012.html#gacb4c45a8b06492753c41014f447033a7">report_memory_usage</a> (void)</td></tr>
<tr class="memdesc:gacb4c45a8b06492753c41014f447033a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reports memory usage, installed by atexit().  <a href="a00012.html#gacb4c45a8b06492753c41014f447033a7">More...</a><br /></td></tr>
<tr class="separator:gacb4c45a8b06492753c41014f447033a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga26f0d51829ee9299385f21b8d8778aed"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="a00011.html#gaa3c04ba804275765a4e49c9872d46a25">Arena</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00013.html#ga26f0d51829ee9299385f21b8d8778aed">_arena_init</a> (size_t chunk_sz)</td></tr>
<tr class="memdesc:ga26f0d51829ee9299385f21b8d8778aed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes an arena and configures it with the effective chunk_size, and allocates the memory, with malloc().  <a href="a00013.html#ga26f0d51829ee9299385f21b8d8778aed">More...</a><br /></td></tr>
<tr class="separator:ga26f0d51829ee9299385f21b8d8778aed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f9f9b3f235f325ded53faac132739c5"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00013.html#ga4f9f9b3f235f325ded53faac132739c5">_alloc</a> (<a class="el" href="a00011.html#gaa3c04ba804275765a4e49c9872d46a25">Arena</a> **p, size_t mem_sz, size_t n)</td></tr>
<tr class="memdesc:ga4f9f9b3f235f325ded53faac132739c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory from an arena a new arena if necessary for delivering the request.  <a href="a00013.html#ga4f9f9b3f235f325ded53faac132739c5">More...</a><br /></td></tr>
<tr class="separator:ga4f9f9b3f235f325ded53faac132739c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga04a5fcf57840c0bade8e4c484d7d47c5"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00015.html#ga04a5fcf57840c0bade8e4c484d7d47c5">arena_alloc</a> (size_t n, size_t mem_sz)</td></tr>
<tr class="memdesc:ga04a5fcf57840c0bade8e4c484d7d47c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory for an object from an arena.  <a href="a00015.html#ga04a5fcf57840c0bade8e4c484d7d47c5">More...</a><br /></td></tr>
<tr class="separator:ga04a5fcf57840c0bade8e4c484d7d47c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23b25e45295065752b480c579880a763"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00015.html#ga23b25e45295065752b480c579880a763">arena_calloc</a> (size_t n, size_t nelem, size_t mem_sz)</td></tr>
<tr class="memdesc:ga23b25e45295065752b480c579880a763"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory for an array,zeroes it out.  <a href="a00015.html#ga23b25e45295065752b480c579880a763">More...</a><br /></td></tr>
<tr class="separator:ga23b25e45295065752b480c579880a763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8fcf35141c612af3cdec09827c1fc58b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00015.html#ga8fcf35141c612af3cdec09827c1fc58b">arena_deallocate</a> (size_t n)</td></tr>
<tr class="memdesc:ga8fcf35141c612af3cdec09827c1fc58b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate all objects from a lifetime, when their time is up, but retain the memory for the allocatation of a new set of objects in another lifetime.  <a href="a00015.html#ga8fcf35141c612af3cdec09827c1fc58b">More...</a><br /></td></tr>
<tr class="separator:ga8fcf35141c612af3cdec09827c1fc58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga36b140d5cdd7c000e31603c1faece653"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#ga36b140d5cdd7c000e31603c1faece653">arena_create</a> (size_t n, size_t chunk_sz)</td></tr>
<tr class="memdesc:ga36b140d5cdd7c000e31603c1faece653"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a ready to use arena, and configures the arena to support a chunk_sz.  <a href="a00016.html#ga36b140d5cdd7c000e31603c1faece653">More...</a><br /></td></tr>
<tr class="separator:ga36b140d5cdd7c000e31603c1faece653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2008e68179e73437601ae12825fbd3ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#ga2008e68179e73437601ae12825fbd3ce">arena_destroy</a> (size_t n)</td></tr>
<tr class="memdesc:ga2008e68179e73437601ae12825fbd3ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys an arena frees all memory.  <a href="a00016.html#ga2008e68179e73437601ae12825fbd3ce">More...</a><br /></td></tr>
<tr class="separator:ga2008e68179e73437601ae12825fbd3ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gae830127e69da3bbdebeb576ef125033d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="a00011.html#gaa3c04ba804275765a4e49c9872d46a25">Arena</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00011.html#gae830127e69da3bbdebeb576ef125033d">first</a> [<a class="el" href="a00008.html#a87cc5fd59a28dced587d8bfa5bee3a13">ARENAS_MAX</a>]</td></tr>
<tr class="memdesc:gae830127e69da3bbdebeb576ef125033d"><td class="mdescLeft">&#160;</td><td class="mdescRight">A head pointer to the first arena.  <a href="a00011.html#gae830127e69da3bbdebeb576ef125033d">More...</a><br /></td></tr>
<tr class="separator:gae830127e69da3bbdebeb576ef125033d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae7bb043307e173efc40c0e4b1474e5e0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="a00011.html#gaa3c04ba804275765a4e49c9872d46a25">Arena</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00011.html#gae7bb043307e173efc40c0e4b1474e5e0">arenas</a> [<a class="el" href="a00008.html#a87cc5fd59a28dced587d8bfa5bee3a13">ARENAS_MAX</a>]</td></tr>
<tr class="memdesc:gae7bb043307e173efc40c0e4b1474e5e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backing Array for accessing and using arenas.  <a href="a00011.html#gae7bb043307e173efc40c0e4b1474e5e0">More...</a><br /></td></tr>
<tr class="separator:gae7bb043307e173efc40c0e4b1474e5e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacef28bc038df55a7044c47c87724cf84"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00011.html#gacef28bc038df55a7044c47c87724cf84">msgBadArena</a> = &quot;Bad <a class="el" href="a00020.html">arena</a> %lu: max arena: %d see <a class="el" href="a00008.html#a87cc5fd59a28dced587d8bfa5bee3a13">ARENAS_MAX</a> in core_arena.h\n&quot;</td></tr>
<tr class="memdesc:gacef28bc038df55a7044c47c87724cf84"><td class="mdescLeft">&#160;</td><td class="mdescRight">error message string for an out of range arena numberer.  <a href="a00011.html#gacef28bc038df55a7044c47c87724cf84">More...</a><br /></td></tr>
<tr class="separator:gacef28bc038df55a7044c47c87724cf84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga180bc7368f9b80af02e461ed7b7dc466"><td class="memItemLeft" align="right" valign="top">const ptrdiff_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00011.html#ga180bc7368f9b80af02e461ed7b7dc466">_AHS</a> = sizeof( <a class="el" href="a00011.html#gaa3c04ba804275765a4e49c9872d46a25">Arena</a> )</td></tr>
<tr class="memdesc:ga180bc7368f9b80af02e461ed7b7dc466"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arena Header Size.  <a href="a00011.html#ga180bc7368f9b80af02e461ed7b7dc466">More...</a><br /></td></tr>
<tr class="separator:ga180bc7368f9b80af02e461ed7b7dc466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab0b000acde5fb04d183e03119697afd7"><td class="memItemLeft" align="right" valign="top">static unsigned long long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00012.html#gab0b000acde5fb04d183e03119697afd7">allocated_chunks</a> [<a class="el" href="a00008.html#a87cc5fd59a28dced587d8bfa5bee3a13">ARENAS_MAX</a>]</td></tr>
<tr class="separator:gab0b000acde5fb04d183e03119697afd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0955ebdd26c5cc641ea6032006b9182d"><td class="memItemLeft" align="right" valign="top">static unsigned long long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00012.html#ga0955ebdd26c5cc641ea6032006b9182d">allocation_chunk_count</a> [<a class="el" href="a00008.html#a87cc5fd59a28dced587d8bfa5bee3a13">ARENAS_MAX</a>]</td></tr>
<tr class="separator:ga0955ebdd26c5cc641ea6032006b9182d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A general purpose arena strategy that is based on malloc. </p>
<h3><a class="anchor" id="autotoc_md10"></a>
Objective</h3>
<p>Makefile an easy to used arena memory allocation library, thatt coexists nicely with malloc and libraries that utilizes malloc.</p>
<p>Have fast lifetime oriented allocation of memory, without individually freeing memory and memory leaks, although dangling pointers are still possible. Allocating larger chunks from malloc that is later on serving smaller memory allocation requests, thingss keeps the heap less fragmented, The memory allocated by to us by mallocloc is easy to return a chunk when we don't need it anymore , this will lower the overall memory usage of your program.</p>
<h3><a class="anchor" id="autotoc_md11"></a>
Task</h3>
<p>Implement a dynamic arena allocation strategy, that dynamically allocate as much memory we need, when the amount isn't known, with a faillsafe if the ask is greater than the configure buffer size for the arena.</p>
<h3><a class="anchor" id="autotoc_md12"></a>
Caveat</h3>
<p>The library doessn't support dynamic arrayays I feel that realloc/realloc arrayay is much better suited for that, they must be freed individually, with free().</p>
<h3><a class="anchor" id="autotoc_md13"></a>
Intended usage:</h3>
<p>The intended usage is to used the arena for individually allocating many small things, like structs, nodes, hash table values (nodes), strings and the like, maybe stored in a dynamic resizable array, allocated, and resized with stdlib's realloc.</p>
<p>chunk_sz: I personally intended to use a pagesize of my system's <em>PG_SZ</em>, which in my case, on an x86-64 linux system is 4096 bytes. That, or multiples of that size is the most efficient chunk sz both speed and memory wise,if larger quantities of memory is feasible. Smaller quantities made up of some quotient after a division by some power of two are also good: 2048, 1024,512,256 etc, and so are also combinations like 3072, 1536, 768, you get the idea.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
Design</h3>
<p>The design is founded upon three different sources:</p>
<p>First and foremost based on the seminal paper: ["Fast Allocation and Deallocation of
 Memory Based on Object Lifetimes" by David R Hanson](<a href="https://www.cs.princeton.edu/techreports/1988/191.pdf">https://www.cs.princeton.edu/techreports/1988/191.pdf</a>).</p>
<p>Secondly by u/skeetos/Chris Wellons' blog posts concerning arena memory allocation strategies. Especially his posts <a href="https://nullprogram.com/blog/2023/09/27/">Arena allocators tips and tricks</a> and <a href="https://nullprogram.com/blog/2023/10/05/">A simple, arena-backed, generic dynamic array for c</a></p>
<p>I have also used the rudimentary implementation of alloc in K&amp;R Second edition, chp. 8.7 as a foundation for knowledge on the subject, and William Stallings "Operating
 Systems internals and design principles" concerning memory managment strategies.</p>
<p>My own idea, even if maybe implicit in the others' ideas, is to explicitly use malloc and free for the basic memory managment to avoid any <code>malloc/realloc/reallocarray</code> versus <code>sbrk</code> conflict situations, that either maybe create holes in memory, or distort pointers, due to the fact that an arena has to be moved, during reallocation.</p>
<p>When we free an arena by destroying it we return the memory to the general pool of free core memory, so the memory can be used for whatever purpose malloc/realloc/reallocarray or other libraries that allocate memory, needs free memory for. Keeping a low memory consumption.</p>
<p>If we know we are going to reuse the memory for the same arena, then we can simply deallocate, and the previousvly malloced() memory will be readyily availiable for reuse.</p>
<h3><a class="anchor" id="autotoc_md15"></a>
Implementation</h3>
<p>Coding wise I have amalgated the code from David R Hanson and Chris Wellons when it comes to use variable names, I think Wellons' names: "begin" and "end" is better than Hansons' "avail" and "limit", their purpose are otherwise the same.</p>
<p>The code is written for the c99 standard, using the Amd-x86-64 ABI, for a <b>linux</b> Unix System, You may want to change the MAX_ALIGN to better suit your needs for your architecture, and depending on what attributes your compiler has available your may also want to change the padding/alignmentent of <code>struct arena</code>.</p>
<p>If you are going to port the code to a non <b>linux</b> , then you should implement checking for NULL after having called <code>malloc()</code>.</p>
<p>Thanks to u/skeeto for reviewing my code and thereby hardening it.</p>
<p>The whole correspondence can be found at: <a href="https://www.reddit.com/r/C_Programming/comments/18r7vwy/an_arena_backed_memory_allocator_after_my_own_head/">https://www.reddit.com/r/C_Programming/comments/18r7vwy/an_arena_backed_memory_allocator_after_my_own_head/</a></p>
<p>Thank you again u/skeeto, your effort is highly appreciated. </p>

<p class="definition">Definition in file <a class="el" href="a00005_source.html">core_arena.c</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 29 2023 22:09:40 for core_arena by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
